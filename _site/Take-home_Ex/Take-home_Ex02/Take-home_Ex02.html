<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-02-16">

<title>IS415-GAA - Take-home Exercise 2: Spatio-Temporal Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">IS415-GAA</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-hands-on-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Hands-on Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-hands-on-exercise">    
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex01/Hands-on_Ex01.html">
 <span class="dropdown-text">Hands-on Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex02/Hands-on_Ex02.html">
 <span class="dropdown-text">Hands-on Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex03/Hands-on_Ex03.html">
 <span class="dropdown-text">Hands-on Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Hands-on_Ex/Hands-on_Ex06/Hands-on_Ex06.html">
 <span class="dropdown-text">Hands-on Exercise 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-in-class-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">In-class Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-in-class-exercise">    
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex02/In-class_Ex02.html">
 <span class="dropdown-text">In-class Exercise 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex03/In-class_Ex03.html">
 <span class="dropdown-text">In-class Exercise 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex04/In-class_Ex04.html">
 <span class="dropdown-text">In-class Exercise 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex05/In-class_Ex05.html">
 <span class="dropdown-text">In-class Exercise 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex06/In-class_Ex06.html">
 <span class="dropdown-text">In-class Exercise 6</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../In-class_Ex/In-class_Ex07/In-class_Ex07.html">
 <span class="dropdown-text">In-class Exercise 7</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-take-home-exercise" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Take-home Exercise</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-take-home-exercise">    
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex01/Take-home_Ex01.html">
 <span class="dropdown-text">Take-home Exercise 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../Take-home_Ex/Take-home_Ex02/Take-home_Ex02.html">
 <span class="dropdown-text">Take-home Exercise 2</span></a>
  </li>  
    </ul>
  </li>
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../about.html">
 <span class="menu-text">About</span></a>
  </li>  
</ul>
              <div id="quarto-search" class="" title="Search"></div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#loading-of-data" id="toc-loading-of-data" class="nav-link active" data-scroll-target="#loading-of-data">1 Loading of Data</a>
  <ul class="collapse">
  <li><a href="#data-sets" id="toc-data-sets" class="nav-link" data-scroll-target="#data-sets">1.1 Data Sets</a></li>
  <li><a href="#geospatial-data" id="toc-geospatial-data" class="nav-link" data-scroll-target="#geospatial-data">1.2 Geospatial Data</a>
  <ul class="collapse">
  <li><a href="#checking-missing-values" id="toc-checking-missing-values" class="nav-link" data-scroll-target="#checking-missing-values">1.2.1 Checking Missing Values</a></li>
  <li><a href="#trimming-outer-island" id="toc-trimming-outer-island" class="nav-link" data-scroll-target="#trimming-outer-island">1.2.2 Trimming Outer Island</a></li>
  <li><a href="#filling-up-na-values" id="toc-filling-up-na-values" class="nav-link" data-scroll-target="#filling-up-na-values">1.2.3 Filling up NA values</a></li>
  <li><a href="#visualising-of-map" id="toc-visualising-of-map" class="nav-link" data-scroll-target="#visualising-of-map">1.2.4 Visualising of Map</a></li>
  <li><a href="#choosing-relavent-fields" id="toc-choosing-relavent-fields" class="nav-link" data-scroll-target="#choosing-relavent-fields">1.2.5 Choosing relavent fields</a></li>
  <li><a href="#translating-columns" id="toc-translating-columns" class="nav-link" data-scroll-target="#translating-columns">1.2.6 Translating columns</a></li>
  </ul></li>
  <li><a href="#aspatial-data" id="toc-aspatial-data" class="nav-link" data-scroll-target="#aspatial-data">1.3 Aspatial Data</a>
  <ul class="collapse">
  <li><a href="#loading-aspatial-data" id="toc-loading-aspatial-data" class="nav-link" data-scroll-target="#loading-aspatial-data">1.3.1 Loading Aspatial data</a></li>
  <li><a href="#columns-in-each-data-set" id="toc-columns-in-each-data-set" class="nav-link" data-scroll-target="#columns-in-each-data-set">1.3.2 Columns in each data set</a></li>
  <li><a href="#crafting-a-function-for-wrangling" id="toc-crafting-a-function-for-wrangling" class="nav-link" data-scroll-target="#crafting-a-function-for-wrangling">1.3.3 Crafting a function for wrangling</a></li>
  <li><a href="#combination-of-aspatial-data" id="toc-combination-of-aspatial-data" class="nav-link" data-scroll-target="#combination-of-aspatial-data">1.3.4 Combination of Aspatial Data</a></li>
  </ul></li>
  <li><a href="#merging-geospatial-and-aspatial-data" id="toc-merging-geospatial-and-aspatial-data" class="nav-link" data-scroll-target="#merging-geospatial-and-aspatial-data">1.4 Merging Geospatial and Aspatial Data</a></li>
  </ul></li>
  <li><a href="#chloropleth-mapping" id="toc-chloropleth-mapping" class="nav-link" data-scroll-target="#chloropleth-mapping">2 Chloropleth mapping</a>
  <ul class="collapse">
  <li><a href="#creating-a-tmap-function" id="toc-creating-a-tmap-function" class="nav-link" data-scroll-target="#creating-a-tmap-function">2.1 Creating a tmap function</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Take-home Exercise 2: Spatio-Temporal Analysis</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">February 16, 2023</p>
    </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Modified</div>
    <div class="quarto-title-meta-contents">
      <p class="date-modified">March 2, 2023</p>
    </div>
  </div>
    
  </div>
  

</header>

<p>Setting the Context</p>
<section id="loading-of-data" class="level1">
<h1>1 Loading of Data</h1>
<p>We will be loading the packages in using the pacman::p_load function. This is the most efficient way of loading the packages.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(sf, funModeling,maptools,raster, spatstat, tmap , tidyverse, sfdep, readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="data-sets" class="level2">
<h2 class="anchored" data-anchor-id="data-sets">1.1 Data Sets</h2>
<p>We will be using 2 primary sets of data.</p>
<table class="table">
<thead>
<tr class="header">
<th>Data set</th>
<th>Source</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Geospatial</td>
<td><a href="https://www.indonesia-geospasial.com/2020/04/download-shapefile-shp-batas-desa.html" title="INDONESIA GEOSPASIAL">INDONESIA GEOSPASIAL</a></td>
<td>Sub-district of Indonesia</td>
</tr>
<tr class="even">
<td>Aspatial</td>
<td><a href="https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/">Riwayat File Vaksinasi DKI Jakarta</a></td>
<td>Monthly numbers of vaccinated people from July 2021 to June 2022 (sub-district level)</td>
</tr>
</tbody>
</table>
</section>
<section id="geospatial-data" class="level2">
<h2 class="anchored" data-anchor-id="geospatial-data">1.2 Geospatial Data</h2>
<p>We will be loading the Geospatial data while converting it to the proper crs format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>geoJKT <span class="ot">&lt;-</span> <span class="fu">st_read</span>(<span class="at">dsn =</span> <span class="st">"data/geospatial/"</span>, <span class="at">layer =</span> <span class="st">"BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA"</span>) <span class="sc">%&gt;%</span>   <span class="fu">st_transform</span>(<span class="at">crs=</span><span class="dv">23878</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Reading layer `BATAS_DESA_DESEMBER_2019_DUKCAPIL_DKI_JAKARTA' from data source 
  `/Users/keredpoh/Desktop/keredpoh/IS415-GAA/Take-home_Ex/Take-home_Ex02/data/geospatial' 
  using driver `ESRI Shapefile'
Simple feature collection with 269 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 106.3831 ymin: -6.370815 xmax: 106.9728 ymax: -5.184322
Geodetic CRS:  WGS 84</code></pre>
</div>
</div>
<section id="checking-missing-values" class="level3">
<h3 class="anchored" data-anchor-id="checking-missing-values">1.2.1 Checking Missing Values</h3>
<p>We should never assume that the data set provided has no missing values. We check the values in this code chunk and realise that there are actually 14 na values. We will change it in the later portions.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>  <span class="fu">which</span>((<span class="fu">is.na</span>(geoJKT)) <span class="sc">==</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">length</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 14</code></pre>
</div>
</div>
</section>
<section id="trimming-outer-island" class="level3">
<h3 class="anchored" data-anchor-id="trimming-outer-island">1.2.2 Trimming Outer Island</h3>
<p>Let us visualise the original polygon. Notice that there are several island that we do not want, as we are only focusing on the main sub-districts of Jakarta, or mainland for short.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qtm</span>(geoJKT)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From using the View() function, we can see the different columns of geoJKT. With the help of Google translate, we can see that KAB KOTA means city district.</p>
<p><img src="images/Image 1-3-23 at 11.37 AM-01.jpeg" class="img-fluid"></p>
<p>From there, we can further derive that KEPULAUAN SERIBU means outer island, which is something that we do not want for the scope of this assignment. We will use filter() to remove it.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>geoJKT <span class="ot">&lt;-</span> <span class="fu">filter</span>(geoJKT, KAB_KOTA <span class="sc">!=</span> <span class="st">"KEPULAUAN SERIBU"</span>) </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>geoJKT</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 261 features and 161 fields
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 686587.9 ymin: 9295420 xmax: 718314.5 ymax: 9326648
Projected CRS: DGN95 / UTM zone 48S
First 10 features:
   OBJECT_ID  KODE_DESA               DESA   KODE    PROVINSI      KAB_KOTA
1      25477 3173031006          KEAGUNGAN 317303 DKI JAKARTA JAKARTA BARAT
2      25478 3173031007             GLODOK 317303 DKI JAKARTA JAKARTA BARAT
3      25397 3171031003      HARAPAN MULIA 317103 DKI JAKARTA JAKARTA PUSAT
4      25400 3171031006       CEMPAKA BARU 317103 DKI JAKARTA JAKARTA PUSAT
5      25390 3171021001         PASAR BARU 317102 DKI JAKARTA JAKARTA PUSAT
6      25391 3171021002       KARANG ANYAR 317102 DKI JAKARTA JAKARTA PUSAT
7      25394 3171021005 MANGGA DUA SELATAN 317102 DKI JAKARTA JAKARTA PUSAT
8      25386 3171011003       PETOJO UTARA 317101 DKI JAKARTA JAKARTA PUSAT
9      25403 3171041001              SENEN 317104 DKI JAKARTA JAKARTA PUSAT
10     25408 3171041006             BUNGUR 317104 DKI JAKARTA JAKARTA PUSAT
     KECAMATAN         DESA_KELUR JUMLAH_PEN JUMLAH_KK LUAS_WILAY KEPADATAN
1   TAMAN SARI          KEAGUNGAN      21609      7255       0.36     60504
2   TAMAN SARI             GLODOK       9069      3273       0.37     24527
3    KEMAYORAN      HARAPAN MULIA      29085      9217       0.53     54465
4    KEMAYORAN       CEMPAKA BARU      41913     13766       0.97     42993
5  SAWAH BESAR         PASAR BARU      15793      5599       1.76      8971
6  SAWAH BESAR       KARANG ANYAR      33383     11276       0.47     71628
7  SAWAH BESAR MANGGA DUA SELATAN      35906     12817       1.31     27463
8       GAMBIR       PETOJO UTARA      21828      7328       1.14     19144
9        SENEN              SENEN       8643      3049       0.82     10594
10       SENEN             BUNGUR      23001      7944       0.67     34418
   PERPINDAHA JUMLAH_MEN PERUBAHAN WAJIB_KTP SILAM KRISTEN KHATOLIK HINDU BUDHA
1         102         68     20464     16027 15735    2042      927    15  2888
2          25         52      8724      7375  1842    2041     1460     9  3716
3         131        104     27497     20926 26328    1710      531    42   469
4         170        151     38323     30264 36813    3392     1082   127   495
5          58         36     15006     12559  7401    3696     1602   622  2462
6         113         60     31014     24784 23057    4058     2100    25  4134
7         178         92     33021     26730 23424    5130     2575    27  4740
8          87         83     19275     16478 15355    3061     1838     9  1559
9          56         21      8306      6298  5450    1991      705   115   381
10        128         70     21652     16987 17431    3099     1258    47  1143
   KONGHUCU KEPERCAYAA  PRIA WANITA BELUM_KAWI KAWIN CERAI_HIDU CERAI_MATI   U0
1         2          0 11049  10560      10193 10652        255        509 1572
2         1          0  4404   4665       4240  4364        136        329  438
3         5          0 14696  14389      14022 13450        430       1183 2232
4         1          3 21063  20850      20336 19487        523       1567 3092
5        10          0  7833   7960       7578  7321        217        677  802
6         9          0 16887  16496      15860 15945        381       1197 2220
7        10          0 18338  17568      17239 17198        476        993 2399
8         4          2 10955  10873      10551 10070        305        902 1406
9         1          0  4446   4197       4360  3915        101        267  585
10        1         22 11679  11322      11010 11231        206        554 1679
     U5  U10  U15  U20  U25  U30  U35  U40  U45  U50  U55  U60 U65 U70 U75
1  1751 1703 1493 1542 1665 1819 1932 1828 1600 1408 1146  836 587 312 415
2   545  524  521  543  628  691  782  675  607  619  602  614 555 311 414
3  2515 2461 2318 2113 2170 2363 2595 2371 2250 1779 1379 1054 654 411 420
4  3657 3501 3486 3098 3024 3188 3662 3507 3391 2696 1909 1397 970 631 704
5   995 1016 1106 1081 1002 1236 1422 1200 1163 1099  979  880 747 488 577
6  2687 2653 2549 2313 2446 2735 3034 2689 2470 2129 1843 1386 958 554 717
7  2953 2754 2666 2515 2725 3122 3385 3037 2597 2282 1930 1394 932 573 642
8  1625 1625 1718 1612 1612 1707 1806 1746 1672 1427 1258  968 706 412 528
9   758  714  672  583  670  797  796  740  577  495  437  331 234 129 125
10 1794 1797 1789 1667 1773 1957 1952 1785 1667 1489 1219  941 647 386 459
   TIDAK_BELU BELUM_TAMA TAMAT_SD SLTP  SLTA DIPLOMA_I DIPLOMA_II DIPLOMA_IV
1        3426       1964     2265 3660  8463        81        428       1244
2        1200        481      655 1414  3734        23        273       1241
3        4935       2610     2346 3167 12172        84       1121       2477
4        7328       3763     2950 5138 16320       179       1718       4181
5        2121       1278     1169 2236  5993        43        573       2199
6        5075       3241     4424 5858 12448        85        604       1582
7        6089       3184     3620 6159 14080        83        740       1850
8        3290       1951     1660 3008  8743        63        734       2189
9        1401        768      877 1417  2936        27        280        804
10       3506       2065     1609 2918 10155        79        708       1832
   STRATA_II STRATA_III BELUM_TIDA APARATUR_P TENAGA_PEN WIRASWASTA PERTANIAN
1         74          4       3927         81         70       8974         1
2         46          2       1388         10         43       3832         0
3        166          7       5335        513        288      10662         1
4        315         21       8105        931        402      14925         3
5        168         13       2676        156         81       6145         1
6         63          3       5985        132        123      12968         2
7         92          9       6820         79         73      14714         5
8        174         16       3809        145        109       8549         1
9        125          8       1574        369         30       3175         0
10       122          7       3948        609        137       8284         0
   NELAYAN AGAMA_DAN PELAJAR_MA TENAGA_KES PENSIUNAN LAINNYA    GENERATED
1        0         6       4018         28        57    4447 30 Juni 2019
2        0         6       1701         29        50    2010 30 Juni 2019
3        2         5       6214         80       276    5709 30 Juni 2019
4        0        40       9068        142       498    7799 30 Juni 2019
5        1        49       3135         60        59    3430 30 Juni 2019
6        1        10       6823         48        56    7235 30 Juni 2019
7        2        11       6866         55        75    7206 30 Juni 2019
8        0        54       4731         68        97    4265 30 Juni 2019
9        0        15       1779         89        53    1559 30 Juni 2019
10       0        16       5063         93       146    4705 30 Juni 2019
   KODE_DES_1 BELUM_ MENGUR_ PELAJAR_ PENSIUNA_1 PEGAWAI_ TENTARA KEPOLISIAN
1  3173031006   3099    4447     3254         80       48       4         10
2  3173031007   1032    2026     1506         65        5       0          1
3  3171031003   4830    5692     6429        322      366      41         16
4  3171031006   7355    7692     8957        603      612      57         42
5  3171021001   2390    3500     3185         70       65      74          2
6  3171021002   5330    7306     6993         75       73      20         17
7  3171021005   5605    7042     6858         97       48      12          7
8  3171011003   3365    4357     4719        132       89      11          9
9  3171041001   1553    1627     1701         67       91      90        165
10 3171041006   3924    4731     4885        165      174     340         15
   PERDAG_ PETANI PETERN_ NELAYAN_1 INDUSTR_ KONSTR_ TRANSP_ KARYAW_ KARYAW1
1       31      0       0         1        7       3       2    6735       9
2        5      0       0         0        3       0       0    3034       2
3        1      1       0         1        4       2       7    7347      74
4        3      2       0         0        3       6       4   10185     231
5        2      1       0         0        0       1       0    4319      16
6        3      1       0         0        1       1       0    9405      13
7        1      1       0         1        7       5       3   10844      10
8        0      2       0         0        0       0       0    6909      24
9        1      0       0         0        2       2       0    1959      17
10       2      0       0         0        2       5       0    5661      29
   KARYAW1_1 KARYAW1_12 BURUH BURUH_ BURUH1 BURUH1_1 PEMBANT_ TUKANG TUKANG_1
1          0         23   515      1      0        0        1      0        1
2          0          4   155      0      0        0        1      0        0
3          5         25   971      0      1        0        4      0        0
4         15         35   636      0      0        0        1      0        0
5          0         16   265      1      0        0        7      0        0
6          0          6  1085      0      0        0        5      0        0
7          1          9   652      1      1        0        1      1        0
8          0         11   357      0      0        0        6      0        0
9          2         11   226      0      0        0        1      0        0
10         4         15   542      0      0        0       10      0        0
   TUKANG_12 TUKANG__13 TUKANG__14 TUKANG__15 TUKANG__16 TUKANG__17 PENATA
1          0          1          0          1          7          1      0
2          0          1          0          0          4          0      0
3          0          0          0          0         10          0      0
4          0          1          0          1         14          0      0
5          0          0          0          0          2          0      1
6          0          0          0          0          7          0      0
7          0          1          0          1          8          1      0
8          0          0          0          0          8          0      0
9          0          0          0          0          1          0      1
10         0          1          0          0          0          0      0
   PENATA_ PENATA1_1 MEKANIK SENIMAN_ TABIB PARAJI_ PERANCA_ PENTER_ IMAM_M
1        0         0      11        4     1       0        0       1      0
2        0         0       1        0     0       0        0       0      0
3        0         0      10       12     0       0        0       0      0
4        0         1       8       28     0       0        0       0      0
5        0         0       4        2     1       0        0       1      0
6        0         0       7        3     0       0        0       0      0
7        0         1       8        4     1       0        0       0      0
8        0         2       9        9     0       0        1       0      0
9        0         0       0        6     0       0        0       0      0
10       0         1      15        7     0       0        2       0      0
   PENDETA PASTOR WARTAWAN USTADZ JURU_M PROMOT ANGGOTA_ ANGGOTA1 ANGGOTA1_1
1        2      0        7      6      0      0        0        0          0
2        4      1        1      1      0      0        1        0          0
3        5      0       16      1      0      0        0        0          0
4       33      1       27      5      0      0        0        0          0
5       20      8        4      0      0      0        0        0          0
6       10      0        8      0      0      0        1        0          0
7        8      0        6      1      0      0        0        0          0
8       30     23        9      0      0      0        1        0          0
9       14      0        5      0      0      0        0        0          0
10      14      0        9      1      0      0        0        0          0
   PRESIDEN WAKIL_PRES ANGGOTA1_2 ANGGOTA1_3 DUTA_B GUBERNUR WAKIL_GUBE BUPATI
1         0          0          0          0      0        0          0      0
2         0          0          0          0      0        0          0      0
3         0          0          0          0      0        0          0      0
4         0          0          0          0      0        0          0      0
5         0          0          0          0      0        0          0      0
6         0          0          0          0      0        0          0      0
7         0          0          0          0      0        0          0      0
8         0          0          0          0      0        0          0      0
9         0          0          0          0      0        0          0      0
10        0          0          0          0      0        0          0      0
   WAKIL_BUPA WALIKOTA WAKIL_WALI ANGGOTA1_4 ANGGOTA1_5 DOSEN GURU PILOT
1           0        0          0          0          0     3   72     1
2           0        0          0          0          0     2   40     0
3           0        0          0          0          0    23  272     2
4           0        0          0          0          0    36  378     3
5           0        0          0          0          0    11   69     0
6           0        0          0          0          0     3  126     0
7           0        0          0          0          0     5   71     0
8           0        0          0          0          0    14   97     0
9           0        0          0          0          0     6   23     0
10          0        0          0          0          0    28  106     0
   PENGACARA_ NOTARIS ARSITEK AKUNTA_ KONSUL_ DOKTER BIDAN PERAWAT APOTEK_
1           4       0       1       1       1     16     3       7       0
2           1       0       0       0       0     32     1       0       0
3           8       3       2       0       2     35     9      25       2
4          22       5       3       0      11     68    18      44       3
5           5       4       2       0       4     63     1       3       0
6           5       0       0       0       0     27     3      12       1
7           4       0       0       0       0     32     3      20       2
8           4       5       4       2       6     63     3       7       1
9           3       0       1       0       2     48    10      26       2
10         12       5       2       1       3     60    10      16       3
   PSIKIATER PENYIA_ PENYIA1 PELAUT PENELITI SOPIR PIALAN PARANORMAL PEDAGA_
1          0       0       0      0        0    65      0          0     379
2          0       0       0      0        1     3      0          0     126
3          1       0       0      6        0    94      0          0     321
4          0       0       0     16        0   123      0          0     562
5          0       0       0      0        1    61      0          0     412
6          0       0       0      2        0    76      0          0     202
7          0       0       0      4        0    79      0          1     225
8          0       0       0      2        0    63      0          0     271
9          1       0       0      4        0    44      0          0     212
10         0       0       0      2        0   101      0          0     331
   PERANG_ KEPALA_ BIARAW_ WIRASWAST_ LAINNYA_12 LUAS_DESA KODE_DES_3
1        0       0       0       1370         94     25476 3173031006
2        0       0       1        611         57     25477 3173031007
3        0       0       0       1723         82     25396 3171031003
4        0       0       0       3099        122     25399 3171031006
5        0       0      22       1128         41     25389 3171021001
6        0       0       3       2321         89     25390 3171021002
7        0       0       0       2677        158     25393 3171021005
8        0       0       2       1018         37     25385 3171011003
9        0       0       1        871         15     25402 3171041001
10       0       0       0       1749         94     25407 3171041006
           DESA_KEL_1 KODE_12                       geometry
1           KEAGUNGAN  317303 MULTIPOLYGON (((700997 9320...
2              GLODOK  317303 MULTIPOLYGON (((700826.4 93...
3       HARAPAN MULIA  317103 MULTIPOLYGON (((705543.4 93...
4        CEMPAKA BARU  317103 MULTIPOLYGON (((706164.3 93...
5          PASAR BARU  317102 MULTIPOLYGON (((703261.2 93...
6        KARANG ANYAR  317102 MULTIPOLYGON (((702680.1 93...
7  MANGGA DUA SELATAN  317102 MULTIPOLYGON (((702843.6 93...
8        PETOJO UTARA  317101 MULTIPOLYGON (((701480.2 93...
9               SENEN  317104 MULTIPOLYGON (((703947.8 93...
10             BUNGUR  317104 MULTIPOLYGON (((704573.6 93...</code></pre>
</div>
</div>
</section>
<section id="filling-up-na-values" class="level3">
<h3 class="anchored" data-anchor-id="filling-up-na-values">1.2.3 Filling up NA values</h3>
<p>From looking at View(geoJKT), we see that the 14 NA values are associated with rows 243 and 244. Let us insert the necessary values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>geoJKT<span class="sc">$</span>KAB_KOTA[<span class="dv">243</span>]<span class="ot">&lt;-</span><span class="st">"JAKARTA UTARA"</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>geoJKT<span class="sc">$</span>KAB_KOTA[<span class="dv">244</span>]<span class="ot">&lt;-</span><span class="st">"JAKARTA UTARA"</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>geoJKT<span class="sc">$</span>KODE_DESA[<span class="dv">243</span>]<span class="ot">&lt;-</span><span class="st">"3188888801"</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>geoJKT<span class="sc">$</span>KODE_DESA[<span class="dv">244</span>]<span class="ot">&lt;-</span><span class="st">"3188888802"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="visualising-of-map" class="level3">
<h3 class="anchored" data-anchor-id="visualising-of-map">1.2.4 Visualising of Map</h3>
<p>As shown in the plot, there are no NA values, or outer island. that means that we have successfully removed the outer island and NA values.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tmap_mode</span>(<span class="st">"plot"</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tm_shape</span>(geoJKT) <span class="sc">+</span> </span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tm_polygons</span>(<span class="st">"KAB_KOTA"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="Take-home_Ex02_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="choosing-relavent-fields" class="level3">
<h3 class="anchored" data-anchor-id="choosing-relavent-fields">1.2.5 Choosing relavent fields</h3>
<p>For the scope of this assignment, let us retain the first 9 columns from geoJKT using select().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>geoJKT <span class="ot">&lt;-</span> geoJKT <span class="sc">%&gt;%</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="translating-columns" class="level3">
<h3 class="anchored" data-anchor-id="translating-columns">1.2.6 Translating columns</h3>
<p>As the columns are not in English, let us translate and change the name using rename().</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>geoJKT <span class="ot">&lt;-</span> geoJKT <span class="sc">%&gt;%</span> </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  dplyr<span class="sc">::</span><span class="fu">rename</span>(</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="st">'village_code'</span> <span class="ot">=</span> <span class="st">'KODE_DESA'</span>,</span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="st">'subdistrict'</span> <span class="ot">=</span> <span class="st">'KECAMATAN'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="aspatial-data">1.3 Aspatial Data</h2>
<p>As mentioned earlier, we will be using data from <a href="https://riwayat-file-vaksinasi-dki-jakarta-jakartagis.hub.arcgis.com/">Riwayat File Vaksinasi DKI Jakarta</a>. We will be looking at data from the start of July 2021 till the end of June 2022.</p>
<section id="loading-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="loading-aspatial-data">1.3.1 Loading Aspatial data</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setwd</span>(<span class="st">"data/aspatial/"</span>) </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>files <span class="ot">&lt;-</span> <span class="fu">list.files</span>(<span class="at">pattern =</span> <span class="st">".xlsx"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (file <span class="cf">in</span> files) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">assign</span>(<span class="fu">gsub</span>(<span class="st">".xlsx"</span>, <span class="st">""</span>, file), <span class="fu">read_excel</span>(file))</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="columns-in-each-data-set" class="level3">
<h3 class="anchored" data-anchor-id="columns-in-each-data-set">1.3.2 Columns in each data set</h3>
<p>We can use names() to view the true nature of each name as it is sometimes hidden when we view the table alone.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(<span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Desember 2021)</span><span class="st">`</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "KODE KELURAHAN"                            
 [2] "WILAYAH KOTA"                              
 [3] "KECAMATAN"                                 
 [4] "KELURAHAN"                                 
 [5] "SASARAN"                                   
 [6] "BELUM VAKSIN"                              
 [7] "JUMLAH\r\nDOSIS 1"                         
 [8] "JUMLAH\r\nDOSIS 2"                         
 [9] "TOTAL VAKSIN\r\nDIBERIKAN"                 
[10] "LANSIA\r\nDOSIS 1"                         
[11] "LANSIA\r\nDOSIS 2"                         
[12] "LANSIA TOTAL \r\nVAKSIN DIBERIKAN"         
[13] "PELAYAN PUBLIK\r\nDOSIS 1"                 
[14] "PELAYAN PUBLIK\r\nDOSIS 2"                 
[15] "PELAYAN PUBLIK TOTAL\r\nVAKSIN DIBERIKAN"  
[16] "GOTONG ROYONG\r\nDOSIS 1"                  
[17] "GOTONG ROYONG\r\nDOSIS 2"                  
[18] "GOTONG ROYONG TOTAL\r\nVAKSIN DIBERIKAN"   
[19] "TENAGA KESEHATAN\r\nDOSIS 1"               
[20] "TENAGA KESEHATAN\r\nDOSIS 2"               
[21] "TENAGA KESEHATAN TOTAL\r\nVAKSIN DIBERIKAN"
[22] "TAHAPAN 3\r\nDOSIS 1"                      
[23] "TAHAPAN 3\r\nDOSIS 2"                      
[24] "TAHAPAN 3 TOTAL\r\nVAKSIN DIBERIKAN"       
[25] "REMAJA\r\nDOSIS 1"                         
[26] "REMAJA\r\nDOSIS 2"                         
[27] "REMAJA TOTAL\r\nVAKSIN DIBERIKAN"          </code></pre>
</div>
</div>
</section>
<section id="crafting-a-function-for-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="crafting-a-function-for-wrangling">1.3.3 Crafting a function for wrangling</h3>
<p>As there are 12 different data sets, data wrangling is not as simple.</p>
<ul>
<li><p>we will have to combine them together using a list</p></li>
<li><p>select relevant columns</p></li>
<li><p>translating to English</p></li>
<li><p>mutate a new column for total population &amp; vaccination rate</p></li>
<li><p>create a date column for each data set.</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>wrangle_function <span class="ot">&lt;-</span><span class="cf">function</span>(data){</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a> df_name <span class="ot">&lt;-</span> <span class="fu">deparse</span>(<span class="fu">substitute</span>(data))</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a> wrangle<span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">select</span>( <span class="st">`</span><span class="at">KODE KELURAHAN</span><span class="st">`</span>, </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">WILAYAH KOTA</span><span class="st">`</span>, </span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>          KECAMATAN, </span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>          KELURAHAN, </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>          <span class="st">`</span><span class="at">BELUM VAKSIN</span><span class="st">`</span>, </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>          SASARAN) <span class="sc">%&gt;%</span> </span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>   <span class="fu">rename</span>(<span class="at">village_code =</span> <span class="st">`</span><span class="at">KODE KELURAHAN</span><span class="st">`</span>, </span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>          <span class="at">city_region =</span><span class="st">`</span><span class="at">WILAYAH KOTA</span><span class="st">`</span>, </span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>          <span class="at">subdistrict =</span> <span class="st">`</span><span class="at">KECAMATAN</span><span class="st">`</span>, </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>          <span class="at">district =</span> <span class="st">`</span><span class="at">KELURAHAN</span><span class="st">`</span>, </span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a>          <span class="at">target_vaccination =</span> <span class="st">`</span><span class="at">SASARAN</span><span class="st">`</span>, </span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>          <span class="at">not_vaccinated =</span> <span class="st">`</span><span class="at">BELUM VAKSIN</span><span class="st">`</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">total_population =</span> target_vaccination) <span class="sc">%&gt;%</span> </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vaccination_rate =</span> (target_vaccination<span class="sc">-</span>not_vaccinated)<span class="sc">/</span>total_population)</span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a> <span class="fu">return</span>(wrangle)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let us manually input the month according to chronological order, and run the data frames through the function we just created. We will also be using as.Date() to ensure the date format.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>list_month <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Juli 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (1 Agustus 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 September 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Oktober 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 November 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Desember 2021)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Januari 2022)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Februari 2022)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (02 Maret 2022)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 April 2022)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Mei 2022)</span><span class="st">`</span>, <span class="st">`</span><span class="at">Data Vaksinasi Berbasis Kelurahan (01 Juli 2021)</span><span class="st">`</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>date <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"2021-7-1"</span>, <span class="st">"2021-8-1"</span>, <span class="st">"2021-9-1"</span>, <span class="st">"2021-10-1"</span>, <span class="st">"2021-11-1"</span>, <span class="st">"2021-12-1"</span>, <span class="st">"2022-1-1"</span>, <span class="st">"2022-2-1"</span>, <span class="st">"2022-3-1"</span>, <span class="st">"2022-4-1"</span>, <span class="st">"2022-5-1"</span>, <span class="st">"2022-6-1"</span>)</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>lists <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">12</span>)){</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  lists[[i]] <span class="ot">&lt;-</span> <span class="fu">wrangle_function</span>(list_month[[i]]) <span class="sc">|&gt;</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">date =</span> <span class="fu">as.Date</span>(date[i]),</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>           <span class="at">.before =</span> <span class="dv">1</span>)</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="combination-of-aspatial-data" class="level3">
<h3 class="anchored" data-anchor-id="combination-of-aspatial-data">1.3.4 Combination of Aspatial Data</h3>
<p>We will combine them into a single data frame using Reduce()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>aspatial <span class="ot">&lt;-</span> <span class="fu">Reduce</span>(rbind, lists)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(aspatial)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 3,216
Columns: 9
$ date               &lt;date&gt; 2021-07-01, 2021-07-01, 2021-07-01, 2021-07-01, 20…
$ village_code       &lt;chr&gt; NA, "3172051003", "3173041007", "3175041005", "3175…
$ city_region        &lt;chr&gt; NA, "JAKARTA UTARA", "JAKARTA BARAT", "JAKARTA TIMU…
$ subdistrict        &lt;chr&gt; NA, "PADEMANGAN", "TAMBORA", "KRAMAT JATI", "JATINE…
$ district           &lt;chr&gt; "TOTAL", "ANCOL", "ANGKE", "BALE KAMBANG", "BALI ME…
$ not_vaccinated     &lt;dbl&gt; 5041111, 13272, 16477, 18849, 5743, 15407, 12503, 1…
$ target_vaccination &lt;dbl&gt; 7739060, 20393, 25785, 25158, 8683, 22768, 18930, 2…
$ total_population   &lt;dbl&gt; 7739060, 20393, 25785, 25158, 8683, 22768, 18930, 2…
$ vaccination_rate   &lt;dbl&gt; 0.3486146, 0.3491884, 0.3609851, 0.2507751, 0.33859…</code></pre>
</div>
</div>
</section>
</section>
<section id="merging-geospatial-and-aspatial-data" class="level2">
<h2 class="anchored" data-anchor-id="merging-geospatial-and-aspatial-data">1.4 Merging Geospatial and Aspatial Data</h2>
<p>We will be merging both data sets by village codes, as it is present in both. Similarly to Geospatial data, we will have to filter out the outer island in Aspatial data, categorised by KAB.ADM.KEP.SERIBU as it is not present in the Geospatial data.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(aspatial<span class="sc">$</span>city_region)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA                   "JAKARTA UTARA"      "JAKARTA BARAT"     
[4] "JAKARTA TIMUR"      "JAKARTA SELATAN"    "JAKARTA PUSAT"     
[7] "KAB.ADM.KEP.SERIBU"</code></pre>
</div>
</div>
<p>We will remove it through filter()</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>aspatial <span class="ot">&lt;-</span> aspatial <span class="sc">%&gt;%</span> </span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">filter</span>(city_region <span class="sc">!=</span> <span class="st">"KAB.ADM.KEP.SERIBU"</span>) </span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(aspatial<span class="sc">$</span>city_region) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "JAKARTA UTARA"   "JAKARTA BARAT"   "JAKARTA TIMUR"   "JAKARTA SELATAN"
[5] "JAKARTA PUSAT"  </code></pre>
</div>
</div>
<p>We use setdiff() to see what is present in geoJKT which is not in aspatial.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(geoJKT<span class="sc">$</span>village_code, aspatial<span class="sc">$</span>village_code)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "3188888801" "3188888802"</code></pre>
</div>
</div>
<p>We will manually add the two sub districts so that both data frames will match after joining.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>aspatial <span class="ot">&lt;-</span> <span class="fu">rbind</span>(aspatial, <span class="fu">c</span>(<span class="st">"2021-07-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-08-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-09-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-10-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-11-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-12-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-01-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-02-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-03-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-04-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-05-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-06-01"</span>, <span class="dv">3188888801</span>,<span class="cn">NA</span>),</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-07-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-08-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-09-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-10-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-11-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2021-12-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-01-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-02-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-03-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-04-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-05-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>),</span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a>                       <span class="fu">c</span>(<span class="st">"2022-06-01"</span>, <span class="dv">3188888802</span>,<span class="cn">NA</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Indeed, there are no NA values. We are good to go.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">setdiff</span>(geoJKT<span class="sc">$</span>subdistrict, aspatial<span class="sc">$</span>subdistrict)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "KALIDERES"  "PAL MERAH"  "SETIABUDI"  "PULOGADUNG" "KRAMATJATI"</code></pre>
</div>
</div>
<p>Let us finally join both datasets using left_join() by village code</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>vaccinationJKT <span class="ot">&lt;-</span> <span class="fu">left_join</span>(aspatial, geoJKT, </span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>                         <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"village_code"</span>, <span class="st">"subdistrict"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">vaccination_rate =</span> <span class="fu">as.numeric</span>(vaccination_rate)) <span class="sc">%&gt;%</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">st_as_sf</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We will then select the important columns</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>vaccinationJKT <span class="sc">%&gt;%</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(date, village_code, subdistrict, vaccination_rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Simple feature collection with 3156 features and 4 fields (with 444 geometries empty)
Geometry type: MULTIPOLYGON
Dimension:     XY
Bounding box:  xmin: 688150.7 ymin: 9295420 xmax: 718314.5 ymax: 9326648
Projected CRS: DGN95 / UTM zone 48S
# A tibble: 3,156 × 5
   date       village_code subdistrict      vaccinat…¹                  geometry
   &lt;date&gt;     &lt;chr&gt;        &lt;chr&gt;                 &lt;dbl&gt;        &lt;MULTIPOLYGON [m]&gt;
 1 2021-07-01 3172051003   PADEMANGAN            0.349 (((706161.9 9323032, 706…
 2 2021-07-01 3173041007   TAMBORA               0.361 (((699268 9320073, 69927…
 3 2021-07-01 3175041005   KRAMAT JATI           0.251                     EMPTY
 4 2021-07-01 3175031003   JATINEGARA            0.339 (((706070 9313044, 70607…
 5 2021-07-01 3175101006   CIPAYUNG              0.323 (((711830 9302993, 71181…
 6 2021-07-01 3174031002   MAMPANG PRAPATAN      0.340 (((700371 9308387, 70038…
 7 2021-07-01 3175051002   PASAR REBO            0.444 (((704532.3 9301182, 704…
 8 2021-07-01 3175041004   KRAMAT JATI           0.267                     EMPTY
 9 2021-07-01 3171071002   TANAH ABANG           0.395 (((700406 9314413, 70040…
10 2021-07-01 3175031002   JATINEGARA            0.276 (((706499.5 9311596, 706…
# … with 3,146 more rows, and abbreviated variable name ¹​vaccination_rate</code></pre>
</div>
</div>
</section>
</section>
<section id="chloropleth-mapping" class="level1">
<h1>2 Chloropleth mapping</h1>
<section id="creating-a-tmap-function" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-tmap-function">2.1 Creating a tmap function</h2>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>